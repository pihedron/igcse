<script lang="ts">
  import Button from '$lib/components/Button.svelte'
  import Icon from '$lib/components/Icon.svelte'
  import { auth } from '$lib/firebase'
  import { onMount } from 'svelte'
  import { fade, fly, scale } from 'svelte/transition'

  let ready = false

  function start() {
    ready = true

    function update() {
      requestAnimationFrame(update)
      const els = document.querySelectorAll('.highlight') as NodeListOf<HTMLElement>
      for (const el of els) {
        const top = el.getBoundingClientRect().top
        const y = window.scrollY
        el.style.backgroundPosition = `${Math.min(Math.max(0, 1 - (1.5 * (y - top)) / window.innerHeight), 1) * 100}% 0%`
      }
    }

    update()
  }

  onMount(start)
</script>

{#if ready}
  <div class="hero auto">
    <h1 transition:fly={{ y: -32, duration: 750 }} data-scroll data-scroll-speed="0.2">
      Be an academic weapon!
    </h1>
    <p transition:fly={{ y: 32, duration: 750 }}>
      <span data-scroll data-scroll-speed="0.2">No cost.</span>
      <span data-scroll data-scroll-speed="0.1">No ads.</span>
      <span data-scroll data-scroll-speed="0.3">No tricks.</span>
      <span data-scroll data-scroll-speed="0.2">Just high quality study material.</span>
    </p>
    <div transition:fly={{ y: 32, duration: 750, delay: 250 }} class="buttons">
      {#if auth.currentUser}
        <Button click={(e) => window.open('/exam', '_self')}>Take the test</Button>
      {:else}
        <Button click={(e) => window.open('/join', '_self')}>Sign up</Button>
        <Button click={(e) => window.open('#about', '_self')}>
          Learn more <Icon fontSize={20}>arrow_downward</Icon>
        </Button>
      {/if}
    </div>
  </div>
  <div class="auto">
    <div class="preview" transition:scale={{ start: 0.5, duration: 750, delay: 500 }}>
      <iframe
        src="https://www.youtube.com/embed/6ZyTqfFCnjg"
        title="The solution feels like HACKING!"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        referrerpolicy="strict-origin-when-cross-origin"
        allowfullscreen
      ></iframe>
    </div>
  </div>
  <div class="auto parallax center">
    <h1 data-scroll data-scroll-speed="-0.25">LET'S GO</h1>
  </div>
  <div id="about" class="auto">
    <h2 class="highlight">Take your learning to the next level!</h2>
    <section>
      <div>
        <p>
          IGCSE Pages is an <a href="https://github.com/pihedron/igcse">open-source</a> project that
          aims to bridge the gap between learners and cutting-edge resourcses. Our team consists of
          volunteers from diverse backgrounds who sacrifice their time to make revision notes, topic
          questions, and interactive pages for <strong>YOU</strong>.
        </p>
      </div>
      <div class="img center">
        <svg viewBox="0 0 655 683" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M620 635.614C620 661.294 481.21 682.114 310 682.114C138.79 682.114 3.86719e-06 661.294 3.86719e-06 635.614C3.86719e-06 617.434 69.57 601.684 170.96 594.044C212.77 590.884 260.01 589.114 310 589.114C330.55 589.114 350.63 589.414 370.05 589.984C512.52 594.184 620 613.013 620 635.614Z"
            fill="#3F3D56"
          />
          <path
            opacity="0.1"
            d="M270 645.114C335.722 645.114 389 638.622 389 630.614C389 622.605 335.722 616.114 270 616.114C204.278 616.114 151 622.605 151 630.614C151 638.622 204.278 645.114 270 645.114Z"
            fill="black"
          />
          <path
            d="M269.5 641.114C331.632 641.114 382 587.388 382 521.114C382 454.839 331.632 401.114 269.5 401.114C207.368 401.114 157 454.839 157 521.114C157 587.388 207.368 641.114 269.5 641.114Z"
            fill="#3F3D56"
          />
          <path d="M305 592.114H235V656.114H305V592.114Z" class="accent" />
          <path
            d="M396.5 607.614L392.5 629.614L418.5 633.614L435.5 623.614L434.5 607.614H396.5Z"
            fill="#575A89"
          />
          <path
            d="M265.5 194.614C265.5 194.614 263.5 217.614 258.5 218.614C253.5 219.614 269.5 259.614 269.5 259.614H293.5L312.5 254.614L303.5 232.614C303.5 232.614 291.5 216.614 300.5 203.614C309.5 190.614 265.5 194.614 265.5 194.614Z"
            fill="#A0616A"
          />
          <path
            opacity="0.1"
            d="M265.5 194.614C265.5 194.614 263.5 217.614 258.5 218.614C253.5 219.614 269.5 259.614 269.5 259.614H293.5L312.5 254.614L303.5 232.614C303.5 232.614 291.5 216.614 300.5 203.614C309.5 190.614 265.5 194.614 265.5 194.614Z"
            fill="black"
          />
          <path
            d="M215.5 370.614C215.5 370.614 189.5 420.614 210.5 430.614C231.5 440.614 236.5 439.614 236.5 442.614C236.5 445.614 232.5 444.614 234.5 449.614C236.5 454.614 230.5 474.614 236.5 486.614C242.5 498.614 240.5 507.614 240.5 507.614C240.5 507.614 240.5 508.614 242.5 512.614C244.5 516.614 245.5 519.614 244.5 521.614C243.5 523.614 237.5 536.614 243.5 539.614C249.5 542.614 280.5 544.614 283.5 539.614C286.5 534.614 280.5 531.614 283.5 528.614C286.5 525.614 288.5 524.614 286.5 522.614C284.5 520.614 282.5 495.614 282.5 495.614C282.5 495.614 287.5 466.614 285.5 462.614C283.5 458.614 280.5 454.614 282.5 451.614C284.5 448.614 286.5 449.614 287.5 445.614C288.5 441.614 290.5 432.614 290.5 432.614L301.5 431.614L327.5 436.614C327.5 436.614 356.5 468.614 388.5 478.614C388.5 478.614 397.5 487.614 400.5 487.614C403.5 487.614 403.5 487.614 402.5 489.614C401.5 491.614 398.5 491.614 400.5 493.614C402.5 495.614 405.5 492.614 403.5 495.614C401.5 498.614 399.5 498.614 401.5 500.614C403.5 502.614 400.5 513.614 400.5 514.614C400.5 515.614 391.5 609.614 394.5 611.614C397.5 613.614 439.5 619.614 442.5 611.614C445.5 603.614 440.5 593.614 440.5 593.614C440.5 593.614 455.5 473.614 451.5 465.614C447.5 457.614 433.5 421.614 358.5 398.614C358.5 398.614 337.5 394.614 337.5 391.614C337.5 388.614 335.5 369.614 331.5 368.614C327.5 367.614 304.5 366.614 304.5 366.614L275.5 375.614L235.5 368.614L215.5 370.614Z"
            fill="#2F2E41"
          />
          <path
            d="M250.5 538.614L245.5 556.614C245.5 556.614 241.5 585.614 246.5 592.614C250.427 598.112 257.44 604.844 270.444 606.026C274.089 606.36 277.739 605.44 280.79 603.419C283.841 601.397 286.11 598.395 287.223 594.908C287.372 594.491 287.465 594.055 287.5 593.614C287.5 591.614 284.5 567.614 284.5 567.614L279.5 542.614L278.5 535.614L250.5 538.614Z"
            fill="#2F2E41"
          />
          <path
            d="M396.5 624.614C396.5 624.614 391.5 619.614 390.5 624.614C389.5 629.614 385.5 650.614 392.5 651.614C399.5 652.614 466.5 662.614 473.5 658.614C480.5 654.614 493.5 648.614 485.5 645.614C477.5 642.614 454.5 633.614 454.5 633.614C454.5 633.614 441.5 616.614 439.5 615.614C437.5 614.614 426.5 616.614 421.5 620.614C416.5 624.614 396.5 624.614 396.5 624.614Z"
            fill="#2F2E41"
          />
          <path
            d="M289.5 215.614C306.621 215.614 320.5 201.734 320.5 184.614C320.5 167.493 306.621 153.614 289.5 153.614C272.379 153.614 258.5 167.493 258.5 184.614C258.5 201.734 272.379 215.614 289.5 215.614Z"
            fill="#A0616A"
          />
          <path
            d="M286.5 254.614L274.5 241.614L261.199 215.614C261.199 215.614 251.5 212.614 249.5 217.614C247.5 222.614 211.5 238.614 211.5 238.614C211.5 238.614 220.5 322.614 216.5 330.614C212.5 338.614 205.5 370.614 211.5 373.614C217.5 376.614 245.5 373.614 254.5 377.614C263.5 381.614 289.5 381.614 296.5 376.614C303.5 371.614 305.5 367.614 312.5 370.614C318.459 373.168 332.391 285.853 336.402 259.833C336.74 257.647 336.459 255.411 335.592 253.377C334.724 251.343 333.305 249.592 331.494 248.323C322.521 242.029 306.361 231.183 303.5 232.614C299.5 234.614 286.5 254.614 286.5 254.614Z"
            fill="#575A89"
          />
          <path
            d="M329.5 250.614C331.848 251.201 333.961 252.492 335.553 254.315C337.146 256.137 338.143 258.404 338.411 260.809L346.5 333.614C346.5 333.614 326.5 376.614 316.5 347.614C306.5 318.614 329.5 250.614 329.5 250.614Z"
            fill="#575A89"
          />
          <path
            d="M327.5 340.614L349.5 334.614C349.5 334.614 353.5 362.614 357.5 362.614C361.5 362.614 343.5 378.614 334.5 376.614C325.5 374.614 312.5 367.614 311.5 362.614C310.5 357.614 320.5 336.614 320.5 336.614L327.5 340.614Z"
            fill="#575A89"
          />
          <path
            d="M266.098 197.987C268.206 193.339 267.84 187.917 269.583 183.12C270.516 180.551 272.03 178.233 274.008 176.347C275.985 174.461 278.372 173.057 280.981 172.245C283.591 171.434 286.352 171.237 289.051 171.67C291.749 172.102 294.311 173.153 296.536 174.739C298.778 176.338 301.025 178.583 303.762 178.278C306.708 177.95 309.337 174.662 312.046 175.867C315.049 177.202 314.238 182.584 317.28 183.827C318.881 184.481 320.773 183.474 321.697 182.011C322.505 180.474 322.945 178.771 322.983 177.035C323.402 172.77 323.782 168.256 321.932 164.39C321.154 163.08 320.476 161.712 319.904 160.3C319.58 158.981 319.45 157.622 319.518 156.266C319.501 151.253 324.22 153.832 321.697 149.5C317.28 148 316.399 147.841 311 146.5C305.601 145.159 300.043 141.222 294.5 141.691C285.337 142.467 285.5 138 275.5 140C272.015 140 269.583 141.691 266.098 143.5C264 144.589 260.5 147.5 259.5 152.5C257.5 159 255.303 156.718 252.236 162.5C250.761 164.951 253.151 169.535 252.236 172.245C251.471 175 248.154 177.035 250.5 180.5C251.805 182.427 250.597 183.657 252.236 185.233C253.86 186.794 254.62 189.797 256.419 190.979C257.989 192.012 259.87 191.283 261.472 192.377C263.528 193.782 263.676 196.861 266.098 197.987Z"
            fill="#2F2E41"
          />
          <path
            d="M291.5 269.614L294.5 263.614C294.5 263.614 338.5 276.614 347.5 288.614C347.5 288.614 369.5 274.614 381.5 276.614L393.5 278.614L356.5 311.614L309.5 307.614L291.5 269.614Z"
            fill="#F2F2F2"
          />
          <path
            d="M289.5 263.614L248.5 320.614L307.5 349.614C307.5 349.614 313.016 352.614 317.258 349.614L356.5 331.614L393.5 278.614L356.5 297.614C356.5 297.614 352.5 289.614 344.5 293.614L289.5 263.614Z"
            class="accent"
          />
          <path
            d="M352.5 364.614L360.5 343.614C360.5 343.614 378.5 320.614 368.5 309.614C358.5 298.614 347.5 341.614 347.5 341.614L352.5 364.614Z"
            fill="#A0616A"
          />
          <path
            d="M260.198 361.262L277.654 347.11C277.654 347.11 304.764 336.245 301.632 321.713C298.501 307.18 267.412 338.858 267.412 338.858L260.198 361.262Z"
            fill="#A0616A"
          />
          <path
            opacity="0.1"
            d="M217 260.114H216C216 260.114 200.5 241.614 197.5 266.614C194.5 291.614 184.5 374.614 210.5 377.614C236.5 380.614 255 365.114 255 365.114C255 365.114 274 336.114 267 336.114C263.613 336.114 254.402 334.592 246 335.114C237.037 335.67 228.984 338.194 229.5 335.614C230.5 330.614 245 267.114 217 260.114Z"
            fill="black"
          />
          <path
            d="M215.5 240.614L211.5 238.614C211.5 238.614 195.5 241.614 192.5 266.614C189.5 291.614 179.5 374.614 205.5 377.614C231.5 380.614 266.5 373.614 266.5 373.614C266.5 373.614 273.5 335.614 266.5 335.614C259.5 335.614 223.5 340.614 224.5 335.614C225.5 330.614 243.5 247.614 215.5 240.614Z"
            fill="#575A89"
          />
          <path d="M338 353.114L349.027 336.213L356 364.114L338 372.114V353.114Z" fill="#575A89" />
          <path
            d="M111.473 112.114C126.385 112.114 138.473 100.025 138.473 85.1135C138.473 70.2019 126.385 58.1135 111.473 58.1135C96.5614 58.1135 84.4731 70.2019 84.4731 85.1135C84.4731 100.025 96.5614 112.114 111.473 112.114Z"
            class="mix"
            fill-opacity="0.1"
          />
          <path
            d="M143.473 286.114H79.4731V350.114H143.473V286.114Z"
            class="mix"
            fill-opacity="0.1"
          />
          <path
            d="M372 0L388.199 28.057L404.397 56.114H372H339.603L355.801 28.057L372 0Z"
            class="mix"
            fill-opacity="0.1"
          />
          <g id="pi">
            <path
              d="M654.237 168.229C653.849 180.199 650.934 189.794 645.491 197.013C640.048 204.232 633.58 207.842 626.09 207.843C619.989 207.843 614.641 204.31 610.048 197.244C605.452 190.179 603.155 179.31 603.156 164.638C603.156 161.395 603.233 158.306 603.387 155.372C603.541 152.438 603.734 149.658 603.966 147.032L608.021 108.924H581.264C576.631 157.109 572.828 185.777 569.855 194.928C566.881 204.078 561.843 208.653 554.739 208.654C551.532 208.575 548.473 207.293 546.167 205.063C544.831 203.879 543.774 202.412 543.073 200.77C542.371 199.127 542.044 197.349 542.113 195.565C542.113 192.014 544.912 187.053 550.511 180.681C556.109 174.31 559.217 168.499 559.835 163.248L566.785 108.924H555.55C552.382 108.943 549.265 109.717 546.457 111.183C543.873 112.37 541.624 114.181 539.913 116.453L534.932 123.866H530.878C534.66 112.129 539.313 103.307 544.835 97.399C550.355 91.4917 556.707 88.538 563.889 88.538H652.383V108.924H622.499C621.573 118.191 620.858 127.457 620.356 136.723C619.853 145.99 619.602 155.295 619.604 164.638C619.604 170.971 621.071 176.106 624.005 180.044C626.939 183.982 630.607 185.951 635.009 185.951C637.711 185.951 640.549 184.85 643.523 182.65C644.934 181.659 646.116 180.375 646.985 178.886C647.855 177.397 648.392 175.737 648.561 174.021C648.793 172.323 648.967 170.991 649.082 170.024C649.198 169.06 649.256 168.461 649.256 168.229L654.237 168.229Z"
              class="accent"
            />
            <path
              opacity="0.1"
              d="M654.237 168.229C653.849 180.199 650.934 189.794 645.491 197.013C640.048 204.232 633.58 207.842 626.09 207.843C619.989 207.843 614.641 204.31 610.048 197.244C605.452 190.179 603.155 179.31 603.156 164.638C603.156 161.395 603.233 158.306 603.387 155.372C603.541 152.438 603.734 149.658 603.966 147.032L608.021 108.924H581.264C576.631 157.109 572.828 185.777 569.855 194.928C566.881 204.078 561.843 208.653 554.739 208.654C551.532 208.575 548.473 207.293 546.167 205.063C544.831 203.879 543.774 202.412 543.073 200.77C542.371 199.127 542.044 197.349 542.113 195.565C542.113 192.014 544.912 187.053 550.511 180.681C556.109 174.31 559.217 168.499 559.835 163.248L566.785 108.924H555.55C552.382 108.943 549.265 109.717 546.457 111.183C543.873 112.37 541.624 114.181 539.913 116.453L534.932 123.866H530.878C534.66 112.129 539.313 103.307 544.835 97.399C550.355 91.4917 556.707 88.538 563.889 88.538H652.383V108.924H622.499C621.573 118.191 620.858 127.457 620.356 136.723C619.853 145.99 619.602 155.295 619.604 164.638C619.604 170.971 621.071 176.106 624.005 180.044C626.939 183.982 630.607 185.951 635.009 185.951C637.711 185.951 640.549 184.85 643.523 182.65C644.934 181.659 646.116 180.375 646.985 178.886C647.855 177.397 648.392 175.737 648.561 174.021C648.793 172.323 648.967 170.991 649.082 170.024C649.198 169.06 649.256 168.461 649.256 168.229L654.237 168.229Z"
              fill="black"
            />
            <path
              d="M654.237 164.61C653.849 176.58 650.934 186.175 645.491 193.394C640.048 200.613 633.58 204.223 626.09 204.224C619.989 204.224 614.641 200.691 610.048 193.625C605.452 186.56 603.155 175.691 603.156 161.019C603.156 157.776 603.233 154.687 603.387 151.753C603.541 148.819 603.734 146.039 603.966 143.413L608.021 105.305H581.264C576.631 153.49 572.828 182.158 569.855 191.309C566.881 200.459 561.843 205.034 554.739 205.035C551.532 204.956 548.473 203.674 546.167 201.444C544.831 200.26 543.774 198.793 543.073 197.151C542.371 195.508 542.044 193.73 542.113 191.946C542.113 188.395 544.912 183.434 550.511 177.062C556.109 170.691 559.217 164.88 559.835 159.629L566.785 105.305H555.55C552.382 105.324 549.265 106.098 546.457 107.564C543.873 108.751 541.624 110.562 539.913 112.834L534.932 120.247H530.878C534.66 108.51 539.313 99.6879 544.835 93.78C550.355 87.8727 556.707 84.919 563.889 84.919H652.383V105.305H622.499C621.573 114.572 620.858 123.838 620.356 133.104C619.853 142.371 619.602 151.676 619.604 161.019C619.604 167.352 621.071 172.487 624.005 176.425C626.939 180.363 630.607 182.332 635.009 182.332C637.711 182.332 640.549 181.232 643.523 179.031C644.934 178.04 646.116 176.756 646.985 175.267C647.855 173.778 648.392 172.118 648.561 170.402C648.793 168.704 648.967 167.372 649.082 166.405C649.198 165.441 649.256 164.842 649.256 164.61H654.237Z"
              class="accent"
            />
          </g>
        </svg>
      </div>
    </section>
  </div>
{/if}

<style>
  .hero {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0 auto;
    padding: 196px 32px 32px;
    overflow: auto;
  }

  .hero > * {
    text-align: center;
  }

  .hero h1 {
    margin: 0;
    color: transparent;
    background: linear-gradient(to right, var(--color), var(--accent));
    -webkit-background-clip: text;
    background-clip: text;
    font-size: clamp(48px, 10vw, 96px);
  }

  .hero p {
    font-size: clamp(16px, 2.5vw, 24px);
  }

  .hero p span {
    display: inline-block;
  }

  .buttons {
    display: flex;
    gap: 8px;
  }

  .preview {
    margin: 64px 0;
    aspect-ratio: 16 / 9;
    font-size: 0;
  }

  .preview * {
    width: 100%;
    height: 100%;
    border: 2px solid var(--accent);
    border-radius: 16px;
    box-shadow: 0 0 16px 0 var(--accent);
  }

  .parallax {
    height: 25vh;
    overflow: hidden;
  }

  .parallax h1 {
    margin: 0;
    padding: 64px;
    text-align: center;
    font-size: 128px;
  }

  #about {
    padding-top: 64px;
    padding-bottom: 64px;
  }

  .highlight {
    --dim: color-mix(in oklab, var(--color), transparent 90%);
    width: fit-content;
    color: transparent;
    background: linear-gradient(
        to right,
        var(--color) 0%,
        var(--color) 50%,
        var(--dim) 50%,
        var(--dim) 100%
      )
      100% 0 / 200% 100%;
    -webkit-background-clip: text;
    background-clip: text;
  }

  .img.center {
    padding: 32px;
  }

  .img svg {
    width: 75%;
  }

  path {
    transition: all 250ms;
  }

  path.accent {
    fill: var(--accent);
  }

  path.mix {
    fill: var(--color);
    animation: bob 500ms ease-in-out infinite alternate;
  }

  #pi {
    transform-origin: 90% 20%;
    animation: pulse 500ms ease-in-out infinite alternate;
  }

  #pi:hover path {
    fill: var(--color);
  }

  @keyframes bob {
    0% {
      transform: translateY(0);
    }

    100% {
      transform: translateY(16px);
    }
  }

  @keyframes pulse {
    0% {
      transform: scale(1);
    }

    100% {
      transform: scale(0.9);
    }
  }
</style>
